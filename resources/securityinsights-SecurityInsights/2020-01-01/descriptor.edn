{:scheme "https", :host "management.azure.com", :info {:description "API spec for Microsoft.SecurityInsights (Azure Security Insights) resource provider", :title "Security Insights", :version "2020-01-01"}, :ops {:AlertRules_CreateOrUpdateAction {:path "/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.OperationalInsights/workspaces/{workspaceName}/providers/Microsoft.SecurityInsights/alertRules/{ruleId}/actions/{actionId}", :description "Creates or updates the action of alert rule.", :parameters [#:reference{:parameters "ApiVersion"} #:reference{:parameters "SubscriptionId"} #:reference{:parameters "ResourceGroupName"} #:reference{:parameters "WorkspaceName"} #:reference{:parameters "RuleId"} #:reference{:parameters "ActionId"} #:reference{:parameters "Action"}], :verb :put}, :AlertRules_GetAction {:path "/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.OperationalInsights/workspaces/{workspaceName}/providers/Microsoft.SecurityInsights/alertRules/{ruleId}/actions/{actionId}", :description "Gets the action of alert rule.", :parameters [#:reference{:parameters "ApiVersion"} #:reference{:parameters "SubscriptionId"} #:reference{:parameters "ResourceGroupName"} #:reference{:parameters "WorkspaceName"} #:reference{:parameters "RuleId"} #:reference{:parameters "ActionId"}], :verb :get}, :DataConnectors_List {:path "/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.OperationalInsights/workspaces/{workspaceName}/providers/Microsoft.SecurityInsights/dataConnectors", :description "Gets all data connectors.", :parameters [#:reference{:parameters "ApiVersion"} #:reference{:parameters "SubscriptionId"} #:reference{:parameters "ResourceGroupName"} #:reference{:parameters "WorkspaceName"}], :verb :get}, :DataConnectors_Delete {:path "/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.OperationalInsights/workspaces/{workspaceName}/providers/Microsoft.SecurityInsights/dataConnectors/{dataConnectorId}", :description "Delete the data connector.", :parameters [#:reference{:parameters "ApiVersion"} #:reference{:parameters "SubscriptionId"} #:reference{:parameters "ResourceGroupName"} #:reference{:parameters "WorkspaceName"} #:reference{:parameters "DataConnectorId"}], :verb :delete}, :DataConnectors_Get {:path "/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.OperationalInsights/workspaces/{workspaceName}/providers/Microsoft.SecurityInsights/dataConnectors/{dataConnectorId}", :description "Gets a data connector.", :parameters [#:reference{:parameters "ApiVersion"} #:reference{:parameters "SubscriptionId"} #:reference{:parameters "ResourceGroupName"} #:reference{:parameters "WorkspaceName"} #:reference{:parameters "DataConnectorId"}], :verb :get}, :Actions_ListByAlertRule {:path "/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.OperationalInsights/workspaces/{workspaceName}/providers/Microsoft.SecurityInsights/alertRules/{ruleId}/actions", :description "Gets all actions of alert rule.", :parameters [#:reference{:parameters "ApiVersion"} #:reference{:parameters "SubscriptionId"} #:reference{:parameters "ResourceGroupName"} #:reference{:parameters "WorkspaceName"} #:reference{:parameters "RuleId"}], :verb :get}, :AlertRules_List {:path "/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.OperationalInsights/workspaces/{workspaceName}/providers/Microsoft.SecurityInsights/alertRules", :description "Gets all alert rules.", :parameters [#:reference{:parameters "ApiVersion"} #:reference{:parameters "SubscriptionId"} #:reference{:parameters "ResourceGroupName"} #:reference{:parameters "WorkspaceName"}], :verb :get}, :AlertRules_Delete {:path "/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.OperationalInsights/workspaces/{workspaceName}/providers/Microsoft.SecurityInsights/alertRules/{ruleId}", :description "Delete the alert rule.", :parameters [#:reference{:parameters "ApiVersion"} #:reference{:parameters "SubscriptionId"} #:reference{:parameters "ResourceGroupName"} #:reference{:parameters "WorkspaceName"} #:reference{:parameters "RuleId"}], :verb :delete}, :AlertRules_DeleteAction {:path "/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.OperationalInsights/workspaces/{workspaceName}/providers/Microsoft.SecurityInsights/alertRules/{ruleId}/actions/{actionId}", :description "Delete the action of alert rule.", :parameters [#:reference{:parameters "ApiVersion"} #:reference{:parameters "SubscriptionId"} #:reference{:parameters "ResourceGroupName"} #:reference{:parameters "WorkspaceName"} #:reference{:parameters "RuleId"} #:reference{:parameters "ActionId"}], :verb :delete}, :AlertRules_Get {:path "/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.OperationalInsights/workspaces/{workspaceName}/providers/Microsoft.SecurityInsights/alertRules/{ruleId}", :description "Gets the alert rule.", :parameters [#:reference{:parameters "ApiVersion"} #:reference{:parameters "SubscriptionId"} #:reference{:parameters "ResourceGroupName"} #:reference{:parameters "WorkspaceName"} #:reference{:parameters "RuleId"}], :verb :get}, :DataConnectors_CreateOrUpdate {:path "/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.OperationalInsights/workspaces/{workspaceName}/providers/Microsoft.SecurityInsights/dataConnectors/{dataConnectorId}", :description "Creates or updates the data connector.", :parameters [#:reference{:parameters "ApiVersion"} #:reference{:parameters "SubscriptionId"} #:reference{:parameters "ResourceGroupName"} #:reference{:parameters "WorkspaceName"} #:reference{:parameters "DataConnectorId"} #:reference{:parameters "DataConnector"}], :verb :put}, :Operations_List {:path "/providers/Microsoft.SecurityInsights/operations", :description "Lists all operations available Azure Security Insights Resource Provider.", :parameters [#:reference{:parameters "ApiVersion"}], :verb :get}, :AlertRules_CreateOrUpdate {:path "/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.OperationalInsights/workspaces/{workspaceName}/providers/Microsoft.SecurityInsights/alertRules/{ruleId}", :description "Creates or updates the alert rule.", :parameters [#:reference{:parameters "ApiVersion"} #:reference{:parameters "SubscriptionId"} #:reference{:parameters "ResourceGroupName"} #:reference{:parameters "WorkspaceName"} #:reference{:parameters "RuleId"} #:reference{:parameters "AlertRule"}], :verb :put}}, :parameters {:AlertRule {:description "The alert rule", :in "body", :name "alertRule", :required true, :schema #:reference{:definitions "AlertRule"}, :x-ms-parameter-location "method"}, :ConsentId {:description "consent ID", :in "path", :name "consentId", :required true, :type "string", :x-ms-parameter-location "method"}, :SubscriptionId {:description "Azure subscription ID", :in "path", :name "subscriptionId", :pattern "^[0-9A-Fa-f]{8}-([0-9A-Fa-f]{4}-){3}[0-9A-Fa-f]{12}$", :required true, :type "string"}, :ApiVersion {:description "API version for the operation", :enum ["2020-01-01"], :in "query", :name "api-version", :required true, :type "string"}, :ODataFilter {:description "Filters the results, based on a Boolean condition. Optional.", :in "query", :name "$filter", :required false, :type "string", :x-ms-parameter-location "method"}, :ODataOrderBy {:description "Sorts the results. Optional.", :in "query", :name "$orderby", :required false, :type "string", :x-ms-parameter-location "method"}, :DataConnector {:description "The data connector", :in "body", :name "dataConnector", :required true, :schema #:reference{:definitions "DataConnector"}, :x-ms-parameter-location "method"}, :ODataSkipToken {:description "Skiptoken is only used if a previous operation returned a partial result. If a previous response contains a nextLink element, the value of the nextLink element will include a skiptoken parameter that specifies a starting point to use for subsequent calls. Optional.", :in "query", :name "$skipToken", :required false, :type "string", :x-ms-parameter-location "method"}, :ODataTop {:description "Returns only the first n results. Optional.", :format "int32", :in "query", :name "$top", :required false, :type "integer", :x-ms-parameter-location "method"}, :AggregationsName {:description "The aggregation name. Supports - Cases", :in "path", :name "aggregationsName", :required true, :type "string", :x-ms-parameter-location "method"}, :RuleId {:description "Alert rule ID", :in "path", :name "ruleId", :required true, :type "string", :x-ms-parameter-location "method"}, :ActionId {:description "Action ID", :in "path", :name "actionId", :required true, :type "string", :x-ms-parameter-location "method"}, :Settings {:description "The setting", :in "body", :name "settings", :required true, :schema #:reference{:definitions "Settings"}, :x-ms-parameter-location "method"}, :Action {:description "The action", :in "body", :name "action", :required true, :schema #:reference{:definitions "ActionRequest"}, :x-ms-parameter-location "method"}, :EntityQueryId {:description "entity query ID", :in "path", :name "entityQueryId", :required true, :type "string", :x-ms-parameter-location "method"}, :EntityId {:description "entity ID", :in "path", :name "entityId", :required true, :type "string", :x-ms-parameter-location "method"}, :DataConnectorId {:description "Connector ID", :in "path", :name "dataConnectorId", :required true, :type "string", :x-ms-parameter-location "method"}, :AlertRuleTemplateId {:description "Alert rule template ID", :in "path", :name "alertRuleTemplateId", :required true, :type "string", :x-ms-parameter-location "method"}, :ResourceGroupName {:description "The name of the resource group within the user's subscription. The name is case insensitive.", :name "resourceGroupName", :type "string", :minLength 1, :x-ms-parameter-location "method", :maxLength 90, :required true, :in "path", :pattern "^[-\\w\\._\\(\\)]+$"}, :SettingsName {:description "The setting name. Supports- Fusion, UEBA", :in "path", :name "settingsName", :required true, :type "string", :x-ms-parameter-location "method"}, :WorkspaceName {:description "The name of the workspace.", :in "path", :maxLength 90, :minLength 1, :name "workspaceName", :required true, :type "string", :x-ms-parameter-location "method"}}, :definitions {:DataConnectorList {:description "List all the data connectors.", :properties {:nextLink {:description "URL to fetch the next set of data connectors.", :readOnly true, :type "string"}, :value {:description "Array of data connectors.", :items #:reference{:definitions "DataConnector"}, :type "array"}}, :required ["value"]}, :Label {:description "Label that will be used to tag and filter on.", :type "string"}, :UebaSettings {:allOf [#:reference{:definitions "Settings"}], :description "Represents settings for User and Entity Behavior Analytics enablement.", :properties {:properties #:reference{:definitions "UebaSettingsProperties"}}, :type "object", :x-ms-discriminator-value "UebaSettings"}, :AlertRuleTemplatePropertiesBase {:description "Base alert rule template property bag.", :properties {:alertRulesCreatedByTemplateCount {:description "the number of alert rules that were created by this template", :type "integer"}, :createdDateUTC {:description "The time that this alert rule template has been added.", :format "date-time", :readOnly true, :type "string"}, :description {:description "The description of the alert rule template.", :type "string"}, :displayName {:description "The display name for alert rule template.", :type "string"}, :requiredDataConnectors {:description "The required data connectors for this template", :items #:reference{:definitions "AlertRuleTemplateDataSource"}, :type "array"}, :status {:description "The alert rule template status.", :enum ["Installed" "Available" "NotAvailable"], :type "string", :x-ms-enum {:modelAsString true, :name "TemplateStatus", :values [{:description "Alert rule template installed. and can not use more then once", :value "Installed"} {:description "Alert rule template is available.", :value "Available"} {:description "Alert rule template is not available", :value "NotAvailable"}]}}}, :type "object"}, :ActionResponseProperties {:allOf [#:reference{:definitions "ActionPropertiesBase"}], :description "Action property bag.", :properties {:workflowId {:description "The name of the logic app's workflow.", :type "string"}}, :type "object"}, :AADDataConnectorProperties {:allOf [#:reference{:definitions "DataConnectorTenantId"} #:reference{:definitions "DataConnectorWithAlertsProperties"}], :description "AAD (Azure Active Directory) data connector properties.", :type "object"}, :ASCDataConnectorProperties {:allOf [#:reference{:definitions "DataConnectorWithAlertsProperties"}], :description "ASC (Azure Security Center) data connector properties.", :properties {:subscriptionId {:description "The subscription id to connect to, and get the data from.", :type "string"}}, :type "object"}, :ToggleSettingsProperties {:description "toggle property bag.", :properties {:isEnabled {:description "Determines whether the setting is enable or disabled.", :type "boolean"}}, :type "object"}, :ActionRequestProperties {:allOf [#:reference{:definitions "ActionPropertiesBase"}], :description "Action property bag.", :properties {:triggerUri {:description "Logic App Callback URL for this specific workflow.", :type "string"}}, :type "object"}, :AlertRule {:allOf [#:reference{:definitions "ResourceWithEtag"} #:reference{:definitions "AlertRuleKind"}], :description "Alert rule.", :discriminator "kind", :required ["kind"], :type "object"}, :MicrosoftSecurityIncidentCreationAlertRuleProperties {:allOf [#:reference{:definitions "MicrosoftSecurityIncidentCreationAlertRuleCommonProperties"}], :description "MicrosoftSecurityIncidentCreation rule property bag.", :properties {:alertRuleTemplateName {:description "The Name of the alert rule template used to create this rule.", :type "string"}, :description {:description "The description of the alert rule.", :type "string"}, :displayName {:description "The display name for alerts created by this alert rule.", :type "string"}, :enabled {:description "Determines whether this alert rule is enabled or disabled.", :type "boolean"}, :lastModifiedUtc {:description "The last time that this alert has been modified.", :format "date-time", :readOnly true, :type "string"}}, :required ["displayName" "enabled" "productFilter"], :type "object"}, :ScheduledAlertRule {:allOf [#:reference{:definitions "AlertRule"}], :description "Represents scheduled alert rule.", :properties {:properties #:reference{:definitions "ScheduledAlertRuleProperties"}}, :type "object", :x-ms-discriminator-value "Scheduled"}, :AwsCloudTrailDataConnector {:allOf [#:reference{:definitions "DataConnector"}], :description "Represents Amazon Web Services CloudTrail data connector.", :properties {:properties #:reference{:definitions "AwsCloudTrailDataConnectorProperties"}}, :type "object", :x-ms-discriminator-value "AmazonWebServicesCloudTrail"}, :TIDataConnectorProperties {:allOf [#:reference{:definitions "DataConnectorTenantId"}], :description "TI (Threat Intelligence) data connector properties.", :properties {:dataTypes #:reference{:definitions "TIDataConnectorDataTypes"}}, :type "object"}, :Operation {:description "Operation provided by provider", :properties {:display {:description "Properties of the operation", :properties {:description {:description "Description of the operation", :type "string"}, :operation {:description "Operation name", :type "string"}, :provider {:description "Provider name", :type "string"}, :resource {:description "Resource name", :type "string"}}, :type "object"}, :name {:description "Name of the operation", :type "string"}}}, :OfficeDataConnector {:allOf [#:reference{:definitions "DataConnector"}], :description "Represents office data connector.", :properties {:properties #:reference{:definitions "OfficeDataConnectorProperties"}}, :type "object", :x-ms-discriminator-value "Office365"}, :OfficeConsentProperties {:description "Consent property bag.", :properties {:tenantId {:description "The tenantId of the Office365 with the consent.", :type "string"}, :tenantName {:description "The tenant name of the Office365 with the consent.", :readOnly true, :type "string"}}, :type "object"}, :AttackTactic {:description "The severity for alerts created by this alert rule.", :enum ["InitialAccess" "Execution" "Persistence" "PrivilegeEscalation" "DefenseEvasion" "CredentialAccess" "Discovery" "LateralMovement" "Collection" "Exfiltration" "CommandAndControl" "Impact"], :type "string", :x-ms-enum {:modelAsString true, :name "AttackTactic"}}, :AlertsDataTypeOfDataConnector {:description "Alerts data type for data connectors.", :properties {:alerts {:allOf [#:reference{:definitions "DataConnectorDataTypeCommon"}], :description "Alerts data type connection.", :type "object"}}, :type "object"}, :ResourceWithEtag {:description "An azure resource object with an Etag property", :properties {:etag {:description "Etag of the azure resource", :type "string"}, :id {:description "Azure resource Id", :readOnly true, :type "string"}, :name {:description "Azure resource name", :readOnly true, :type "string"}, :type {:description "Azure resource type", :readOnly true, :type "string"}}, :x-ms-azure-resource true}, :AlertRuleTemplateDataSource {:description "alert rule template data sources", :properties {:connectorId {:description "The connector id that provides the following data types", :type "string"}, :dataTypes {:description "The data types used by the alert rule template", :items {:type "string"}, :type "array"}}, :type "object"}, :DataConnector {:allOf [#:reference{:definitions "ResourceWithEtag"} #:reference{:definitions "DataConnectorKind"}], :description "Data connector.", :discriminator "kind", :required ["kind"], :type "object"}, :ToggleSettings {:allOf [#:reference{:definitions "Settings"}], :description "Settings with single toggle.", :properties {:properties #:reference{:definitions "ToggleSettingsProperties"}}, :type "object", :x-ms-discriminator-value "ToggleSettings"}, :AATPDataConnector {:allOf [#:reference{:definitions "DataConnector"}], :description "Represents AATP (Azure Advanced Threat Protection) data connector.", :properties {:properties #:reference{:definitions "AATPDataConnectorProperties"}}, :type "object", :x-ms-discriminator-value "AzureAdvancedThreatProtection"}, :FusionAlertRule {:allOf [#:reference{:definitions "AlertRule"}], :description "Represents Fusion alert rule.", :properties {:properties #:reference{:definitions "FusionAlertRuleProperties"}}, :type "object", :x-ms-discriminator-value "Fusion"}, :ScheduledAlertRuleCommonProperties {:description "Schedule alert rule template property bag.", :properties {:query {:description "The query that creates alerts for this rule.", :type "string"}, :queryFrequency {:description "The frequency (in ISO 8601 duration format) for this alert rule to run.", :format "duration", :type "string"}, :queryPeriod {:description "The period (in ISO 8601 duration format) that this alert rule looks at.", :format "duration", :type "string"}, :severity #:reference{:definitions "AlertSeverity"}, :triggerOperator #:reference{:definitions "AlertRuleTriggerOperator"}, :triggerThreshold {:description "The threshold triggers this alert rule.", :type "integer"}}, :type "object"}, :MicrosoftSecurityIncidentCreationAlertRuleTemplate {:allOf [#:reference{:definitions "AlertRuleTemplate"}], :description "Represents MicrosoftSecurityIncidentCreation rule template.", :properties {:properties {:allOf [#:reference{:definitions "AlertRuleTemplatePropertiesBase"} #:reference{:definitions "MicrosoftSecurityIncidentCreationAlertRuleCommonProperties"}], :description "MicrosoftSecurityIncidentCreation rule template properties", :required ["displayName" "description" "createdDateUTC" "status" "alertRulesCreatedByTemplateCount" "productFilter"], :x-ms-client-flatten true}}, :type "object", :x-ms-discriminator-value "MicrosoftSecurityIncidentCreation"}, :DataConnectorKind {:description "Describes an Azure resource with kind.", :properties {:kind {:description "The kind of the data connector", :enum ["AzureActiveDirectory" "AzureSecurityCenter" "MicrosoftCloudAppSecurity" "ThreatIntelligence" "Office365" "AmazonWebServicesCloudTrail" "AzureAdvancedThreatProtection" "MicrosoftDefenderAdvancedThreatProtection"], :type "string", :x-ms-enum {:modelAsString true, :name "DataConnectorKind", :values [{:value "AzureActiveDirectory"} {:value "AzureSecurityCenter"} {:value "MicrosoftCloudAppSecurity"} {:value "ThreatIntelligence"} {:value "Office365"} {:value "AmazonWebServicesCloudTrail"} {:value "AzureAdvancedThreatProtection"} {:value "MicrosoftDefenderAdvancedThreatProtection"}]}}}, :type "object"}, :MDATPDataConnector {:allOf [#:reference{:definitions "DataConnector"}], :description "Represents MDATP (Microsoft Defender Advanced Threat Protection) data connector.", :properties {:properties #:reference{:definitions "MDATPDataConnectorProperties"}}, :type "object", :x-ms-discriminator-value "MicrosoftDefenderAdvancedThreatProtection"}, :TIDataConnector {:allOf [#:reference{:definitions "DataConnector"}], :description "Represents threat intelligence data connector.", :properties {:properties #:reference{:definitions "TIDataConnectorProperties"}}, :type "object", :x-ms-discriminator-value "ThreatIntelligence"}, :FusionAlertRuleTemplate {:allOf [#:reference{:definitions "AlertRuleTemplate"}], :description "Represents Fusion alert rule template.", :properties {:properties {:allOf [#:reference{:definitions "AlertRuleTemplatePropertiesBase"}], :description "Fusion alert rule template properties", :properties {:severity #:reference{:definitions "AlertSeverity"}, :tactics {:description "The tactics of the alert rule template", :items #:reference{:definitions "AttackTactic"}, :type "array"}}, :required ["displayName" "description" "status" "severity" "alertRulesCreatedByTemplateCount"], :x-ms-client-flatten true}}, :type "object", :x-ms-discriminator-value "Fusion"}, :OfficeConsent {:allOf [#:reference{:definitions "Resource"}], :description "Consent for Office365 tenant that already made.", :properties {:properties #:reference{:definitions "OfficeConsentProperties"}}, :type "object"}, :MicrosoftSecurityIncidentCreationAlertRuleCommonProperties {:description "MicrosoftSecurityIncidentCreation rule common property bag.", :properties {:displayNamesFilter {:description "the alerts' displayNames on which the cases will be generated", :items {:type "string"}, :type "array"}, :productFilter {:description "The alerts' productName on which the cases will be generated", :enum ["Microsoft Cloud App Security" "Azure Security Center" "Azure Advanced Threat Protection" "Azure Active Directory Identity Protection" "Azure Security Center for IoT"], :type "string", :x-ms-enum {:modelAsString true, :name "MicrosoftSecurityProductName"}}, :severitiesFilter {:description "the alerts' severities on which the cases will be generated", :items #:reference{:definitions "AlertSeverity"}, :type "array"}}, :required ["productFilter"], :type "object"}, :UserInfo {:description "User information that made some action", :properties {:email {:description "The email of the user.", :readOnly true, :type "string"}, :name {:description "The name of the user.", :readOnly true, :type "string"}, :objectId {:description "The object id of the user.", :format "uuid", :type "string", :x-nullable true}}, :required ["objectId"], :type "object"}, :ActionsList {:description "List all the actions.", :properties {:nextLink {:description "URL to fetch the next set of actions.", :readOnly true, :type "string"}, :value {:description "Array of actions.", :items #:reference{:definitions "ActionResponse"}, :type "array"}}, :required ["value"]}, :AATPDataConnectorProperties {:allOf [#:reference{:definitions "DataConnectorTenantId"} #:reference{:definitions "DataConnectorWithAlertsProperties"}], :description "AATP (Azure Advanced Threat Protection) data connector properties.", :type "object"}, :CloudError {:description "Error response structure.", :properties {:error #:reference{:definitions "CloudErrorBody"}}, :type "object", :x-ms-external true}, :OfficeConsentList {:description "List of all the office365 consents.", :properties {:nextLink {:description "URL to fetch the next set of office consents.", :readOnly true, :type "string"}, :value {:description "Array of the consents.", :items #:reference{:definitions "OfficeConsent"}, :type "array"}}, :required ["value"]}, :ActionResponse {:allOf [#:reference{:definitions "Resource"}], :description "Action for alert rule.", :properties {:etag {:description "Etag of the action.", :type "string"}, :properties #:reference{:definitions "ActionResponseProperties"}}, :type "object"}, :SettingsKind {:description "Describes an Azure resource with kind.", :properties {:kind {:description "The kind of the setting", :enum ["UebaSettings" "ToggleSettings"], :type "string", :x-ms-enum {:modelAsString true, :name "SettingKind"}}}, :type "object"}, :DataConnectorTenantId {:description "Properties data connector on tenant level.", :properties {:tenantId {:description "The tenant id to connect to, and get the data from.", :type "string"}}, :type "object"}, :DataConnectorDataTypeCommon {:description "Common field for data type in data connectors.", :properties {:state {:description "Describe whether this data type connection is enabled or not.", :enum ["Enabled" "Disabled"], :type "string", :x-ms-enum {:modelAsString true, :name "DataTypeState"}}}, :type "object"}, :MDATPDataConnectorProperties {:allOf [#:reference{:definitions "DataConnectorTenantId"} #:reference{:definitions "DataConnectorWithAlertsProperties"}], :description "MDATP (Microsoft Defender Advanced Threat Protection) data connector properties.", :type "object"}, :ScheduledAlertRuleTemplate {:allOf [#:reference{:definitions "AlertRuleTemplate"}], :description "Represents scheduled alert rule template.", :properties {:properties {:allOf [#:reference{:definitions "AlertRuleTemplatePropertiesBase"} #:reference{:definitions "ScheduledAlertRuleCommonProperties"}], :description "Scheduled alert rule template properties", :properties {:tactics {:description "The tactics of the alert rule template", :items #:reference{:definitions "AttackTactic"}, :type "array"}}, :required ["displayName" "description" "status" "alertRulesCreatedByTemplateCount" "severity" "query" "queryFrequency" "queryPeriod" "triggerOperator" "triggerThreshold"], :x-ms-client-flatten true}}, :type "object", :x-ms-discriminator-value "Scheduled"}, :TIDataConnectorDataTypes {:description "The available data types for TI (Threat Intelligence) data connector.", :properties {:indicators {:allOf [#:reference{:definitions "DataConnectorDataTypeCommon"}], :description "Data type for indicators connection.", :type "object"}}, :type "object"}, :AwsCloudTrailDataConnectorDataTypes {:description "The available data types for Amazon Web Services CloudTrail data connector.", :properties {:logs {:allOf [#:reference{:definitions "DataConnectorDataTypeCommon"}], :description "Logs data type.", :type "object"}}, :type "object"}, :OfficeDataConnectorDataTypes {:description "The available data types for office data connector.", :properties {:exchange {:allOf [#:reference{:definitions "DataConnectorDataTypeCommon"}], :description "Exchange data type connection.", :type "object"}, :sharePoint {:allOf [#:reference{:definitions "DataConnectorDataTypeCommon"}], :description "SharePoint data type connection.", :type "object"}}, :type "object"}, :Settings {:allOf [#:reference{:definitions "ResourceWithEtag"} #:reference{:definitions "SettingsKind"}], :description "The Setting.", :discriminator "kind", :required ["kind"], :type "object"}, :MCASDataConnectorProperties {:allOf [#:reference{:definitions "DataConnectorTenantId"}], :description "MCAS (Microsoft Cloud App Security) data connector properties.", :properties {:dataTypes #:reference{:definitions "MCASDataConnectorDataTypes"}}, :type "object"}, :AlertRulesList {:description "List all the alert rules.", :properties {:nextLink {:description "URL to fetch the next set of alert rules.", :readOnly true, :type "string"}, :value {:description "Array of alert rules.", :items #:reference{:definitions "AlertRule"}, :type "array"}}, :required ["value"]}, :IncidentInfo {:description "Describes related incident information for the bookmark", :properties {:incidentId {:description "Incident Id", :type "string"}, :relationName {:description "Relation Name", :type "string"}, :severity {:description "The severity of the incident", :enum ["Critical" "High" "Medium" "Low" "Informational"], :type "string", :x-ms-enum {:modelAsString true, :name "IncidentSeverity", :values [{:description "Critical severity", :value "Critical"} {:description "High severity", :value "High"} {:description "Medium severity", :value "Medium"} {:description "Low severity", :value "Low"} {:description "Informational severity", :value "Informational"}]}}, :title {:description "The title of the incident", :type "string"}}, :required ["incidentId" "severity" "title" "relationName"], :type "object"}, :DataConnectorWithAlertsProperties {:description "Data connector properties.", :properties {:dataTypes #:reference{:definitions "AlertsDataTypeOfDataConnector"}}, :type "object"}, :Resource {:description "An azure resource object", :properties {:id {:description "Azure resource Id", :readOnly true, :type "string"}, :name {:description "Azure resource name", :readOnly true, :type "string"}, :type {:description "Azure resource type", :readOnly true, :type "string"}}, :x-ms-azure-resource true}, :ActionRequest {:allOf [#:reference{:definitions "ResourceWithEtag"}], :description "Action for alert rule.", :properties {:properties #:reference{:definitions "ActionRequestProperties"}}, :type "object"}, :MCASDataConnectorDataTypes {:allOf [#:reference{:definitions "AlertsDataTypeOfDataConnector"}], :description "The available data types for MCAS (Microsoft Cloud App Security) data connector.", :properties {:discoveryLogs {:allOf [#:reference{:definitions "DataConnectorDataTypeCommon"}], :description "Discovery log data type connection.", :type "object"}}, :type "object"}, :AlertRuleTemplate {:allOf [#:reference{:definitions "Resource"} #:reference{:definitions "AlertRuleKind"}], :description "Alert rule template.", :discriminator "kind", :required ["kind"], :type "object"}, :ScheduledAlertRuleProperties {:allOf [#:reference{:definitions "ScheduledAlertRuleCommonProperties"}], :description "Scheduled alert rule base property bag.", :properties {:alertRuleTemplateName {:description "The Name of the alert rule template used to create this rule.", :type "string"}, :description {:description "The description of the alert rule.", :type "string"}, :displayName {:description "The display name for alerts created by this alert rule.", :type "string"}, :enabled {:description "Determines whether this alert rule is enabled or disabled.", :type "boolean"}, :lastModifiedUtc {:description "The last time that this alert rule has been modified.", :format "date-time", :readOnly true, :type "string"}, :suppressionDuration {:description "The suppression (in ISO 8601 duration format) to wait since last time this alert rule been triggered.", :format "duration", :type "string"}, :suppressionEnabled {:description "Determines whether the suppression for this alert rule is enabled or disabled.", :type "boolean"}, :tactics {:description "The tactics of the alert rule", :items #:reference{:definitions "AttackTactic"}, :type "array"}}, :required ["displayName" "enabled" "severity" "query" "queryFrequency" "queryPeriod" "triggerOperator" "triggerThreshold" "suppressionEnabled" "suppressionDuration"], :type "object"}, :OfficeDataConnectorProperties {:allOf [#:reference{:definitions "DataConnectorTenantId"}], :description "Office data connector properties.", :properties {:dataTypes #:reference{:definitions "OfficeDataConnectorDataTypes"}}, :type "object"}, :AwsCloudTrailDataConnectorProperties {:description "Amazon Web Services CloudTrail data connector properties.", :properties {:awsRoleArn {:description "The Aws Role Arn (with CloudTrailReadOnly policy) that is used to access the Aws account.", :type "string"}, :dataTypes #:reference{:definitions "AwsCloudTrailDataConnectorDataTypes"}}, :type "object"}, :MCASDataConnector {:allOf [#:reference{:definitions "DataConnector"}], :description "Represents MCAS (Microsoft Cloud App Security) data connector.", :properties {:properties #:reference{:definitions "MCASDataConnectorProperties"}}, :type "object", :x-ms-discriminator-value "MicrosoftCloudAppSecurity"}, :AADDataConnector {:allOf [#:reference{:definitions "DataConnector"}], :description "Represents AAD (Azure Active Directory) data connector.", :properties {:properties #:reference{:definitions "AADDataConnectorProperties"}}, :type "object", :x-ms-discriminator-value "AzureActiveDirectory"}, :AlertRuleKind {:description "Describes an Azure resource with kind.", :properties {:kind {:description "The kind of the alert rule", :enum ["Scheduled" "MicrosoftSecurityIncidentCreation" "Fusion"], :type "string", :x-ms-enum {:modelAsString true, :name "AlertRuleKind", :values [{:value "Scheduled"} {:value "MicrosoftSecurityIncidentCreation"} {:value "Fusion"}]}}}, :required ["kind"], :type "object"}, :AlertSeverity {:description "The severity of the alert", :enum ["High" "Medium" "Low" "Informational"], :type "string", :x-ms-enum {:modelAsString true, :name "AlertSeverity", :values [{:description "High severity", :value "High"} {:description "Medium severity", :value "Medium"} {:description "Low severity", :value "Low"} {:description "Informational severity", :value "Informational"}]}}, :CloudErrorBody {:description "Error details.", :properties {:code {:description "An identifier for the error. Codes are invariant and are intended to be consumed programmatically.", :readOnly true, :type "string"}, :message {:description "A message describing the error, intended to be suitable for display in a user interface.", :readOnly true, :type "string"}}, :type "object", :x-ms-external true}, :OperationsList {:description "Lists the operations available in the SecurityInsights RP.", :properties {:nextLink {:description "URL to fetch the next set of operations.", :type "string"}, :value {:description "Array of operations", :items #:reference{:definitions "Operation"}, :type "array"}}, :required ["value"]}, :FusionAlertRuleProperties {:description "Fusion alert rule base property bag.", :properties {:alertRuleTemplateName {:description "The Name of the alert rule template used to create this rule.", :type "string"}, :description {:description "The description of the alert rule.", :readOnly true, :type "string"}, :displayName {:description "The display name for alerts created by this alert rule.", :readOnly true, :type "string"}, :enabled {:description "Determines whether this alert rule is enabled or disabled.", :type "boolean"}, :lastModifiedUtc {:description "The last time that this alert has been modified.", :format "date-time", :readOnly true, :type "string"}, :severity #:reference{:definitions "AlertSeverity"}, :tactics {:description "The tactics of the alert rule", :items #:reference{:definitions "AttackTactic"}, :readOnly true, :type "array"}}, :required ["alertRuleTemplateName" "enabled"], :type "object"}, :ActionPropertiesBase {:description "Action property bag base.", :properties {:logicAppResourceId {:description "Logic App Resource Id, providers/Microsoft.Logic/workflows/{WorkflowID}.", :type "string"}}, :required ["logicAppResourceId"], :type "object"}, :AlertRuleTriggerOperator {:description "The operation against the threshold that triggers alert rule.", :enum ["GreaterThan" "LessThan" "Equal" "NotEqual"], :type "string", :x-ms-enum {:modelAsString false, :name "TriggerOperator"}}, :ASCDataConnector {:allOf [#:reference{:definitions "DataConnector"}], :description "Represents ASC (Azure Security Center) data connector.", :properties {:properties #:reference{:definitions "ASCDataConnectorProperties"}}, :type "object", :x-ms-discriminator-value "AzureSecurityCenter"}, :ThreatIntelligence {:description "ThreatIntelligence property bag.", :properties {:confidence {:description "Confidence (must be between 0 and 1)", :format "double", :readOnly true, :type "number"}, :providerName {:description "Name of the provider from whom this Threat Intelligence information was received", :readOnly true, :type "string"}, :reportLink {:description "Report link", :readOnly true, :type "string"}, :threatDescription {:description "Threat description (free text)", :readOnly true, :type "string"}, :threatName {:description "Threat name (e.g. \"Jedobot malware\")", :readOnly true, :type "string"}, :threatType {:description "Threat type (e.g. \"Botnet\")", :readOnly true, :type "string"}}, :type "object"}, :UebaSettingsProperties {:description "User and Entity Behavior Analytics settings property bag.", :properties {:atpLicenseStatus {:description "Determines whether the tenant has ATP (Advanced Threat Protection) license.", :enum ["Enabled" "Disabled"], :readOnly true, :type "string", :x-ms-enum {:modelAsString true, :name "LicenseStatus"}}, :isEnabled {:description "Determines whether User and Entity Behavior Analytics is enabled for this workspace.", :type "boolean"}, :statusInMcas {:description "Determines whether User and Entity Behavior Analytics is enabled from MCAS (Microsoft Cloud App Security).", :enum ["Enabled" "Disabled"], :readOnly true, :type "string", :x-ms-enum {:modelAsString true, :name "StatusInMcas"}}}, :type "object"}, :MicrosoftSecurityIncidentCreationAlertRule {:allOf [#:reference{:definitions "AlertRule"}], :description "Represents MicrosoftSecurityIncidentCreation rule.", :properties {:properties #:reference{:definitions "MicrosoftSecurityIncidentCreationAlertRuleProperties"}}, :type "object", :x-ms-discriminator-value "MicrosoftSecurityIncidentCreation"}}}