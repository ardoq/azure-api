{:scheme "https", :host "management.azure.com", :info {:description "API spec for Microsoft.Security (Azure Security Center) resource provider", :title "Security Center", :version "2020-01-01"}, :ops {:Assessments_Delete {:path "/{resourceId}/providers/Microsoft.Security/assessments/{assessmentName}", :description "Delete a security assessment on your resource. An assessment metadata that describes this assessment must be predefined with the same name before inserting the assessment result", :parameters [{:description "API version for the operation", :in "query", :name "api-version", :required true, :type "string"} {:description "The identifier of the resource.", :in "path", :name "resourceId", :required true, :type "string", :x-ms-parameter-location "method"} #:reference{:parameters "AssessmentName"}], :verb :delete}, :Assessments_Get {:path "/{resourceId}/providers/Microsoft.Security/assessments/{assessmentName}", :description "Get a security assessment on your scanned resource", :parameters [{:description "API version for the operation", :in "query", :name "api-version", :required true, :type "string"} {:description "The identifier of the resource.", :in "path", :name "resourceId", :required true, :type "string", :x-ms-parameter-location "method"} #:reference{:parameters "AssessmentName"} #:reference{:parameters "ExpandAssessments"}], :verb :get}, :Assessments_CreateOrUpdate {:path "/{resourceId}/providers/Microsoft.Security/assessments/{assessmentName}", :description "Create a security assessment on your resource. An assessment metadata that describes this assessment must be predefined with the same name before inserting the assessment result", :parameters [{:description "API version for the operation", :in "query", :name "api-version", :required true, :type "string"} {:description "The identifier of the resource.", :in "path", :name "resourceId", :required true, :type "string", :x-ms-parameter-location "method"} #:reference{:parameters "AssessmentName"} #:reference{:parameters "AssessmentBody"}], :verb :put}, :Assessments_List {:path "/{scope}/providers/Microsoft.Security/assessments", :description "Get security assessments on all your scanned resources inside a scope", :parameters [{:description "API version for the operation", :in "query", :name "api-version", :required true, :type "string"} {:description "Scope of the query, can be subscription (/subscriptions/0b06d9ea-afe6-4779-bd59-30e5c2d9d13f) or management group (/providers/Microsoft.Management/managementGroups/mgName).", :in "path", :name "scope", :required true, :type "string", :x-ms-parameter-location "method"}], :verb :get}}, :parameters {:AssessmentBody {:description "Calculated assessment on a pre-defined assessment metadata", :in "body", :name "assessment", :required true, :schema #:reference{:definitions "SecurityAssessment"}, :x-ms-parameter-location "method"}, :AssessmentName {:description "The Assessment Key - Unique key for the assessment type", :in "path", :name "assessmentName", :required true, :type "string", :x-ms-parameter-location "method"}, :ExpandAssessments {:description "OData expand. Optional.", :enum ["links" "metadata"], :in "query", :name "$expand", :required false, :type "string", :x-ms-enum {:modelAsString true, :name "ExpandEnum", :values [{:description "All links associated with an assessment", :value "links"} {:description "Assessment metadata", :value "metadata"}]}, :x-ms-parameter-location "method"}}, :definitions {:AssessmentLinks {:description "Links relevant to the assessment", :properties {:azurePortalUri {:description "Link to assessment in Azure Portal", :readOnly true, :type "string"}}, :readOnly true, :type "object"}, :AssessmentStatus {:description "The result of the assessment", :properties {:cause {:description "Programmatic code for the cause of the assessment status", :type "string"}, :code {:description "Programmatic code for the status of the assessment", :enum ["Healthy" "Unhealthy" "NotApplicable"], :type "string", :x-ms-enum {:modelAsString true, :name "AssessmentStatusCode", :values [{:description "The resource is healthy", :value "Healthy"} {:description "The resource has a security issue that needs to be addressed", :value "Unhealthy"} {:description "Assessment for this resource did not happen", :value "NotApplicable"}]}}, :description {:description "Human readable description of the assessment status", :type "string"}}, :required ["code"], :type "object"}, :SecurityAssessment {:allOf [{:description "Describes an Azure resource.", :properties {:id {:description "Resource Id", :readOnly true, :type "string"}, :name {:description "Resource name", :readOnly true, :type "string"}, :type {:description "Resource type", :readOnly true, :type "string"}}, :type "object", :x-ms-azure-resource true}], :description "Security assessment on a resource", :properties {:properties #:reference{:definitions "SecurityAssessmentProperties"}}, :type "object"}, :SecurityAssessmentList {:description "Page of a security assessments list", :properties {:nextLink {:description "The URI to fetch the next page.", :readOnly true, :type "string"}, :value {:description "Collection of security assessments in this page", :items #:reference{:definitions "SecurityAssessment"}, :readOnly true, :type "array"}}, :type "object"}, :SecurityAssessmentPartnerData {:description "Data regarding 3rd party partner integration", :properties {:secret {:description "secret to authenticate the partner - write only", :type "string", :x-ms-secret true}}, :type "object"}, :SecurityAssessmentProperties {:description "Describes properties of an assessment.", :properties {:additionalData {:additionalProperties {:type "string"}, :description "Additional data regarding the assessment", :type "object"}, :displayName {:description "User friendly display name of the assessment", :readOnly true, :type "string"}, :links #:reference{:definitions "AssessmentLinks"}, :metadata {:description "Describes properties of an assessment metadata.", :properties {:description {:description "Human readable description of the assessment", :type "string"}, :category {:items {:description "The category of resource that is at risk when the assessment is unhealthy", :enum ["Compute" "Networking" "Data" "IdentityAndAccess" "IoT"], :type "string", :x-ms-enum {:modelAsString true, :name "category", :values [{:value "Compute"} {:value "Networking"} {:value "Data"} {:value "IdentityAndAccess"} {:value "IoT"}]}}, :type "array"}, :assessmentType {:description "BuiltIn if the assessment based on built-in Azure Policy definition, Custom if the assessment based on custom Azure Policy definition", :enum ["BuiltIn" "CustomPolicy" "CustomerManaged" "VerifiedPartner"], :type "string", :x-ms-enum {:modelAsString true, :name "assessmentType", :values [{:description "Azure Security Center managed assessments", :value "BuiltIn"} {:description "User defined policies that are automatically ingested from Azure Policy to Azure Security Center", :value "CustomPolicy"} {:description "User assessments pushed directly by the user or other third party to Azure Security Center", :value "CustomerManaged"} {:description "An assessment that was created by a verified 3rd party if the user connected it to ASC", :value "VerifiedPartner"}]}}, :userImpact {:description "The user impact of the assessment", :enum ["Low" "Moderate" "High"], :type "string", :x-ms-enum {:modelAsString true, :name "userImpact", :values [{:value "Low"} {:value "Moderate"} {:value "High"}]}}, :displayName {:description "User friendly display name of the assessment", :type "string"}, :remediationDescription {:description "Human readable description of what you should do to mitigate this security issue", :type "string"}, :preview {:description "True if this assessment is in preview release status", :type "boolean"}, :severity {:description "The severity level of the assessment", :enum ["Low" "Medium" "High"], :type "string", :x-ms-enum {:modelAsString true, :name "severity", :values [{:value "Low"} {:value "Medium"} {:value "High"}]}}, :implementationEffort {:description "The implementation effort required to remediate this assessment", :enum ["Low" "Moderate" "High"], :type "string", :x-ms-enum {:modelAsString true, :name "implementationEffort", :values [{:value "Low"} {:value "Moderate"} {:value "High"}]}}, :partnerData {:description "Describes the partner that created the assessment", :properties {:partnerName {:description "Name of the company of the partner", :readOnly true, :type "string"}, :productName {:description "Name of the product of the partner that created the assessment", :type "string"}, :secret {:description "Secret to authenticate the partner and verify it created the assessment - write only", :type "string", :x-ms-secret true}}, :type "object"}, :policyDefinitionId {:description "Azure resource ID of the policy definition that turns this assessment calculation on", :readOnly true, :type "string"}, :threats {:items {:description "Threats impact of the assessment", :enum ["accountBreach" "dataExfiltration" "dataSpillage" "maliciousInsider" "elevationOfPrivilege" "threatResistance" "missingCoverage" "denialOfService"], :type "string", :x-ms-enum {:modelAsString true, :name "threats", :values [{:value "accountBreach"} {:value "dataExfiltration"} {:value "dataSpillage"} {:value "maliciousInsider"} {:value "elevationOfPrivilege"} {:value "threatResistance"} {:value "missingCoverage"} {:value "denialOfService"}]}}, :type "array"}}, :required ["displayName" "severity" "assessmentType"], :type "object"}, :partnersData #:reference{:definitions "SecurityAssessmentPartnerData"}, :resourceDetails {:description "Details of the resource that was assessed", :discriminator "source", :properties {:source {:description "The platform where the assessed resource resides", :enum ["Azure" "OnPremise"], :type "string", :x-ms-enum {:modelAsString true, :name "source", :values [{:description "Resource is in Azure", :value "Azure"} {:description "Resource in an on premise machine connected to Azure cloud", :value "OnPremise"}]}}}, :required ["source"], :type "object"}, :status #:reference{:definitions "AssessmentStatus"}}, :required ["resourceDetails" "status"], :type "object"}}}